LBL 1
RCL DIM A
Clx
STO MATRIX C
MATRIX 1
1
uSTO C
LBL 0
RCL .5
STO C
x<>y
STO+ 0
uSTO C
GTO 0 
RTN
LBL A
CF 0
SF 1
RCL DIM A
ENTER
DIM C
DIM E
0
STO MATRIX E
R_down
1
STO .2
x<>y
DIM B
EEX
3
CHS
*
+
STO .7
STO .8
STO .9
LBL 2
RCL .7
STO .8
0
STO MATRIX B
1
RCL .9
INT
x>y
GSB 5
GSB 6
LBL 3
2
RCL .8
INT
RCL g A
STO .5
RCL .9
RCL .8
-
X=0
STO .5
X!=0
GSB 7
GSB 1
RCL MATRIX B
RCL MATRIX C
RESULT D
*
RCL MATRIX D
STO MATRIX B
ISG .8
GTO 3
RCL .9
INT
STO 0
1
STO 1
RCL .7
STO .6
LBL 4
1
RCL 1
RCL g B
uSTO E
0
ISG .6
GTO 4
ISG .9
GTO 2 
RCL MATRIX A
MATRIX 4
RCL MATRIX E
MATRIX 4
RESULT B
/
RCL MATRIX A
MATRIX 4
RCL MATRIX B
MATRIX 4
RCL DIM D
DIM B
RCL MATRIX B
RTN
LBL 5
CF 0
SF 1
2
RCL .9
INT
RCL g A
2
RCL .9
INT
1
-
RCL g A
R_up
x=y
SF 0
x=y
CF 1
RTN
LBL 6
1
F? 0
STO+ .2
F? 1
STO .2
1
RCL .2
STO g B
RCL .9
INT
F? 1
STO .3
STO .4
RTN
LBL 7
RCL .3
RCL .8
x<y
RTN
RCL .4
RCL .8
x>y
RTN
0
STO .5
RTN
